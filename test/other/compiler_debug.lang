import "std/memory"

type Test {
	let i : int = 0;
	let t : char* = null_pointer();
}

function destructor(this: Test*) : void {
	printf("Destructor called: Start at %d\n", .i);
	.i = .i + 1;
	printf("                   End at   %d\n", .i);
}

function test() : Test {
	let t : Test;
	return t;
}

function main() {
	let t = test();
	printf("In Main: %d\n", t.i);
	t.i = t.i + 1;
	printf("In Main 2: %d\n", t.i);
	return t.i;
}
